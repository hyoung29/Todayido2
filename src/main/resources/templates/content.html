<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>콘텐츠 정보 보기</title>
    <script src="js/jquery-3.7.1.min.js"></script>
    <!-- Add Bootstrap CSS link -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- Add Bootstrap-datepicker CSS link -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <!-- bxSlider용 라이브러리 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css">
    <script>
        $(function () {
            //bxSlider 설정
            $(".sld").bxSlider({
                auto: false, //수동 순환
                slideWidth: 600 //슬라이더 가로 길이.
            });

            //메시지 출력
            let m = null;
            if (m != null) {
                alert(m);
            }
        });
    </script>
    <script th:inline="javascript">
        $(function () {
            let m = [[${msg}]];
            if (m != null) {
                alert(m);
            }
        })
    </script>
</head>
<body>
<header>
    <th:block th:insert="~{fragments::header(${session.user})}"/>
</header>
<section>
    <div class="cView"> <!-- 상세 정보 background -->
        <div class="c-dak"> <!--성원닭갈비-->
            <img src="images/sungdak.png" alt="성원닭갈비" style="width: 100%">
            <h1 style="font-size: 35px; margin-top: -2px">성원닭갈비<span
                    style="color: #005224; font-size: 25px">(4.1)</span></h1>
            <div class="stats">
                <p>조회 수: 100 회</p>
                <p>예약: 50 회</p>
                <p>찜: 80 회</p>
            </div>
            <h4 style="margin-top: -20px;">010-7793-2058</h4>
            <div class="sl" style="margin: 50px">
                <h3>대표메뉴</h3>
                <div class="sld">
                    <div><img src="images/dak.jpg"></div>
                    <div><img src="images/sdk.jpg"></div>
                </div>
            </div>
            <div class="cont-menu">
                <div class="mnu">
                    <p class="mu">메뉴</p>
                    <div class="ttl">
                        <p>뼈 있는 불 닭갈비</p>
                        <p>순살 불 닭갈비</p>
                        <p>볶음밥</p>
                    </div>
                </div>
                <div class="pay">
                    <p class="mu">가격</p>
                    <div class="ttl">
                        <p>20,000원</p>
                        <p>25,000원</p>
                        <p>2000원</p>
                    </div>
                </div>
                <div class="com" style="margin-top: -13.5px">
                    <p class="mu">설명</p>
                    <div class="nn">
                        <p>뜨끈한 국물 닭갈비가 땡길 때</p>
                        <p>부드러운 닭다리살이 매력있는<span> Best</span>
                            <img src="images/free-icon-like-10904422.png"></p>
                        <p>닭갈비+볶음밥=♥ 말이 필요 없는 조합</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 가게 영업 시간-->
        <div class="store-hour">
            <style>
                .store-hour {
                    height: 140px;
                    border-radius: 40px;
                    background: #D9D9D9;
                    margin-top: 15%;
                }
            </style>
            <div class="c-time">
                <div style="margin: 0 30px; font-size: 18px; font-weight: bolder; line-height: 3;">영업 시간</div>
                <p style="margin: 0 30px;">매일 11:00 ~ 23:00 (22:00 라스트 오더)<br>휴일: 연중 무휴</p>
            </div>
            <div style="text-align: right;">
                <button type="button" class="res" style="margin-top: 45px; font-size: 18px;
                        background-color: white; border-style: none; text-underline: dash;"
                        data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                    <img src="images/schedule.png">예약하기
                </button>
                <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false"
                     tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title" id="staticBackdropLabel">예약하기</h1>
                            </div>
                            <div class="modal-body">
                                <!-- Add your form or content here -->
                                <form id="reservationForm">
                                    <div class="mb-3 text-center">
                                        <label for="date" class="form-label">날짜:</label>
                                        <input type="text" id="date" name="date" class="form-control datepicker"
                                               data-date-format="yyyy-mm-dd" required>
                                    </div>

                                    <div class="mb-3 text-center">
                                        <label for="people" class="form-label">인원수:</label>
                                        <input type="number" id="people" name="people" class="form-control" min="1"
                                               required>
                                    </div>

                                    <div class="mb-3 text-center">
                                        <label for="time" class="form-label">시간:</label>
                                        <input type="time" id="time" name="time" class="form-control" required>
                                    </div>

                                    <div class="btn-class">
                                        <div class="child">
                                            <!-- 예약하기 button -->
                                            <button type="button" class="btn btn-primary" id="saveReservation">저장
                                            </button>
                                            <!-- 예약 취소하기 button -->
                                            <button type="button" class="btn btn-secondary" id="cancelReservation">취소
                                            </button>
                                            <!-- 닫기 button -->
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="c-smp">
                <div style="margin: 0 30px; font-size: 18px; font-weight: bolder; line-height: 3">주소</div>
                <p style="margin: 0 30px;">인천 계양구 아나지로 177</p>
            </div>
            <div class="mp" style="margin-top: 45px; font-size: 18px; text-align: right; line-height: 5">
                <img src="images/map.png"> <a th:href="@{map(store_num=${store_num})}">위치보기</a>
            </div>
        </div>
    </div>
    </div>
</section>
<footer>
    <th:block th:insert="~{fragments::footer}"/>
</footer>
</body>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.1/moment.min.js"></script>
<!-- Your custom scripts here -->
<script>
    $(document).ready(function() {
        $('#date').datepicker({
            format: 'yyyy-mm-dd',
            autoclose: true
        });

        $('#reservationForm').submit(function (event) {
            event.preventDefault();

            // 서버에 예약 데이터 전송 및 예약 수정 처리 로직
            // 아래 코드는 예시로, 실제로는 서버와의 통신을 통해 데이터를 전송하고,
            // 서버에서는 해당 데이터를 받아 처리해야 합니다.

            var formData = {
                date: $('#date').val(),
                people: $('#people').val(),
                time: $('#time').val()
            };

            // Ajax를 사용하여 서버로 데이터 전송
            $.ajax({
                type: 'POST',
                url: '/reservation/saveOrUpdate',  // 수정 또는 신규 예약을 구분할 수 있는 엔드포인트
                data: formData,
                success: function (response) {
                    // 서버로부터의 응답을 처리
                    // 여기에서는 성공 시 메시지를 표시하도록 예시로 작성했습니다.
                    $('#successMessageText').text('예약이 완료되었습니다.');
                    $('#successMessage').show();
                },
                error: function (error) {
                    // 에러 처리
                    console.error('Error:', error);
                }
            });
        });

        // 예약 취소하기 버튼 클릭 이벤트 처리
        $('#cancelReservation').click(function () {
            // 취소 처리 로직을 추가하세요.
            // 아래는 예시로 취소 시 메시지를 표시하는 코드입니다.
            alert('예약이 취소되었습니다.');
            $('#staticBackdrop').modal('hide');  // 모달 닫기
        });
    });
</script>
</html>